作業記録：CloudTrailログの検索・確認（マネジメントコンソール）
1. 作業目的
AWSアカウント内で発生した操作履歴を調査・監査するため、CloudTrailログをマネジメントコンソールから検索・確認する手順を実施。

2. 作業の背景
セキュリティインシデントの初期調査や構成変更の履歴確認が必要となる場面が増えているため。

CLIやAthenaによる検索も可能だが、今回はGUIでの操作手順を標準化目的で記録。

3. 操作手順（マネジメントコンソール）
手順	操作内容
1	AWSマネジメントコンソールにログインし、CloudTrailサービスを開く
2	左メニューより「イベント履歴（Event history）」を選択
3	フィルターを使用し、以下の条件を指定して検索
例：イベント名: ConsoleLogin、結果: 失敗 (SigninFailure)、期間: 過去7日間
4	該当するイベントの詳細をクリックし、ユーザー名・ソースIP・タイムスタンプ・リージョン等を確認
5	必要に応じてCSV形式でログをエクスポート可能（画面右上の「エクスポート」ボタン）

4. 検索のポイント・活用例
特定ユーザーの操作確認
→ フィルターで「ユーザー名」を指定して追跡可能

不正アクセスの兆候確認
→ イベント名を「ConsoleLogin」、結果を「失敗（SigninFailure）」で抽出

リソース作成・削除の操作履歴
→ イベント名に「Create」「Delete」などのキーワードを含めて検索

5. 作業結果・確認内容
対象期間内における不正なConsoleLogin試行はなし

対象ユーザーによるEC2関連操作（例：RunInstances, TerminateInstances）を確認

必要なイベント情報をCSVに出力し、関係者と共有予定

6. 注意点
ログがCloudTrailで記録されるまでに数分のラグがある点に注意

デフォルトでは過去90日間のイベントのみ表示されるため、長期保存を希望する場合はS3バケットへのログ配信設定が必要

GUIでの検索は柔軟性が低いため、複雑な検索はAthena連携が推奨される

補足：イベント履歴と証跡（Trail）の違い、および今回の対応範囲
1. CloudTrailの構成要素
項目	説明
イベント履歴（Event history）	CloudTrailにより自動で取得される過去90日間のマネジメントイベントを、AWSマネジメントコンソールから直接確認できる機能。追加設定不要。
証跡（Trail）	ユーザーが作成・設定することで、全リージョンの操作履歴やデータイベント（例：S3アクセス、Lambda実行など）も記録し、S3保存やAthena分析が可能になる仕組み。

2. 今回の対応範囲と判断理由
今回の作業要件：「CloudTrailログをマネジメントコンソールから確認すること」

そのため、証跡の作成やAthenaによる分析は対象外と判断

過去90日以内の操作ログであれば、イベント履歴から直接検索可能であるため、追加設定を行わずに目的を達成できると判断

🔸 よって、今回は CloudTrailの「イベント履歴」のみを使用し、「証跡（Trail）」の作成・設定は行っていない

3. 今後の補足運用方針（参考）
要件	使用機能	備考
最近の操作確認（90日以内）	イベント履歴	追加設定不要。即時確認可
長期保存・過去ログの蓄積	証跡（Trail）＋S3保存	必要に応じて有効化
高度な分析・検索（例：IP分析、特定API呼び出し）	Trail＋Athena活用	クエリによる柔軟な検索が可能

この内容は、資料や手順書の末尾に補足情報として追記するのが効果的です。
さらに必要であれば、以下のような図解も可能です：

csharp
コピーする
編集する
CloudTrailの構成図（簡易）

[CloudTrail]
   ├── イベント履歴（90日間、即時確認、設定不要）
   └── 証跡（Trail） ─→ S3保存 ─→ Athena / Glue / Lake Formation
