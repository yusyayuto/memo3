Sub CheckSheetNames()
    '========================================
    ' ã‚·ãƒ¼ãƒˆåãƒã‚§ãƒƒã‚¯è¨ºæ–­ãƒã‚¯ãƒ­
    ' æ©Ÿèƒ½ï¼šé–‹ã„ã¦ã„ã‚‹å…¨ãƒ•ã‚¡ã‚¤ãƒ«ã®ã‚·ãƒ¼ãƒˆåã¨è‰²ã‚’ç¢ºèª
    ' ç›®çš„ï¼šãƒãƒ¼ã‚¸å‡¦ç†å‰ã®å•é¡Œç‰¹å®š
    '========================================
    
    Dim wb As Workbook
    Dim ws As Worksheet
    Dim result As String
    Dim redCount As Integer, yellowCount As Integer, otherCount As Integer
    
    result = "ã€å…¨ãƒ•ã‚¡ã‚¤ãƒ«ã®ã‚·ãƒ¼ãƒˆåãƒ»è‰²ãƒã‚§ãƒƒã‚¯ã€‘" & vbNewLine & vbNewLine
    
    ' å„ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ãƒã‚§ãƒƒã‚¯
    For Each wb In Workbooks
        If wb.Name <> ThisWorkbook.Name Then
            result = result & "ãƒ•ã‚¡ã‚¤ãƒ«: " & wb.Name & vbNewLine
            result = result & "--------------------------------" & vbNewLine
            
            For Each ws In wb.Worksheets
                result = result & "ã‚·ãƒ¼ãƒˆå: ã€Œ" & ws.Name & "ã€ â†’ "
                
                ' è‰²ã‚’ãƒã‚§ãƒƒã‚¯
                If ws.Tab.Color = RGB(255, 0, 0) Then
                    result = result & "ğŸ”´ èµ¤è‰²"
                    redCount = redCount + 1
                ElseIf ws.Tab.Color = RGB(255, 255, 0) Then
                    result = result & "ğŸŸ¡ é»„è‰²"
                    yellowCount = yellowCount + 1
                ElseIf ws.Tab.Color = RGB(0, 176, 80) Then
                    result = result & "ğŸŸ¢ ç·‘è‰²"
                    otherCount = otherCount + 1
                ElseIf ws.Tab.Color = RGB(166, 166, 166) Or ws.Tab.Color = RGB(128, 128, 128) Then
                    result = result & "âšª ã‚°ãƒ¬ãƒ¼"
                    otherCount = otherCount + 1
                Else
                    result = result & "â“ ãã®ä»– (Colorå€¤: " & ws.Tab.Color & ")"
                    otherCount = otherCount + 1
                End If
                
                ' ç‰¹æ®Šæ–‡å­—ãƒã‚§ãƒƒã‚¯
                If InStr(ws.Name, "/") > 0 Or InStr(ws.Name, "\") > 0 Or _
                   InStr(ws.Name, "*") > 0 Or InStr(ws.Name, "?") > 0 Or _
                   InStr(ws.Name, "[") > 0 Or InStr(ws.Name, "]") > 0 Or _
                   InStr(ws.Name, ":") > 0 Then
                    result = result & " âš ï¸ç‰¹æ®Šæ–‡å­—ã‚ã‚Š"
                End If
                
                result = result & vbNewLine
            Next ws
            result = result & vbNewLine
        End If
    Next wb
    
    ' ã‚µãƒãƒªãƒ¼
    result = result & "ã€é›†è¨ˆçµæœã€‘" & vbNewLine
    result = result & "ğŸ”´ èµ¤è‰²ã‚·ãƒ¼ãƒˆ: " & redCount & "å€‹" & vbNewLine
    result = result & "ğŸŸ¡ é»„è‰²ã‚·ãƒ¼ãƒˆ: " & yellowCount & "å€‹" & vbNewLine
    result = result & "âšª ãã®ä»–ã‚·ãƒ¼ãƒˆ: " & otherCount & "å€‹" & vbNewLine
    result = result & vbNewLine
    result = result & "ãƒãƒ¼ã‚¸å¯¾è±¡: " & (redCount + yellowCount) & "å€‹ã®ã‚·ãƒ¼ãƒˆ"
    
    ' çµæœè¡¨ç¤ºï¼ˆé•·ã„å ´åˆã¯åˆ†å‰²ï¼‰
    If Len(result) > 1000 Then
        ' çµæœãŒé•·ã„å ´åˆã¯æœ€åˆã®éƒ¨åˆ†ã®ã¿è¡¨ç¤º
        MsgBox Left(result, 1000) & vbNewLine & vbNewLine & "ï¼ˆçµæœãŒé•·ã„ãŸã‚ä¸€éƒ¨çœç•¥ï¼‰", vbInformation, "ã‚·ãƒ¼ãƒˆåãƒã‚§ãƒƒã‚¯çµæœ"
        
        ' è©³ç´°ã‚’ã‚¤ãƒŸãƒ‡ã‚£ã‚¨ã‚¤ãƒˆã‚¦ã‚£ãƒ³ãƒ‰ã‚¦ã«å‡ºåŠ›ï¼ˆãƒ‡ãƒãƒƒã‚°ç”¨ï¼‰
        Debug.Print result
        MsgBox "è©³ç´°çµæœã¯VBã‚¨ãƒ‡ã‚£ã‚¿ã®ã€Œã‚¤ãƒŸãƒ‡ã‚£ã‚¨ã‚¤ãƒˆã‚¦ã‚£ãƒ³ãƒ‰ã‚¦ã€ã«å‡ºåŠ›ã•ã‚Œã¾ã—ãŸã€‚" & vbNewLine & _
               "è¡¨ç¤ºæ–¹æ³•: VBã‚¨ãƒ‡ã‚£ã‚¿ï¼ˆAlt+F11ï¼‰â†’ è¡¨ç¤º â†’ ã‚¤ãƒŸãƒ‡ã‚£ã‚¨ã‚¤ãƒˆã‚¦ã‚£ãƒ³ãƒ‰ã‚¦", vbInformation
    Else
        MsgBox result, vbInformation, "ã‚·ãƒ¼ãƒˆåãƒã‚§ãƒƒã‚¯çµæœ"
    End If
End Sub

'========================================
' ç‰¹æ®Šæ–‡å­—ä¿®æ­£ãƒã‚¯ãƒ­ï¼ˆã‚ªãƒ—ã‚·ãƒ§ãƒ³ï¼‰
'========================================
Sub FixSheetNames()
    'å±é™ºãªç‰¹æ®Šæ–‡å­—ã‚’å®‰å…¨ãªæ–‡å­—ã«ç½®æ›
    Dim wb As Workbook
    Dim ws As Worksheet
    Dim oldName As String, newName As String
    Dim fixCount As Integer
    
    If MsgBox("ã‚·ãƒ¼ãƒˆåã®ç‰¹æ®Šæ–‡å­—ã‚’ä¿®æ­£ã—ã¾ã™ã‹ï¼Ÿ" & vbNewLine & _
              "ï¼ˆ/ \ * ? [ ] : ã‚’ _ ã«ç½®æ›ï¼‰", vbYesNo + vbQuestion, "ç¢ºèª") = vbNo Then
        Exit Sub
    End If
    
    For Each wb In Workbooks
        If wb.Name <> ThisWorkbook.Name Then
            For Each ws In wb.Worksheets
                oldName = ws.Name
                newName = oldName
                
                ' ç‰¹æ®Šæ–‡å­—ã‚’ç½®æ›
                newName = Replace(newName, "/", "_")
                newName = Replace(newName, "\", "_")
                newName = Replace(newName, "*", "_")
                newName = Replace(newName, "?", "_")
                newName = Replace(newName, "[", "_")
                newName = Replace(newName, "]", "_")
                newName = Replace(newName, ":", "_")
                
                If oldName <> newName Then
                    On Error Resume Next
                    ws.Name = newName
                    If Err.Number = 0 Then
                        fixCount = fixCount + 1
                    End If
                    On Error GoTo 0
                End If
            Next ws
        End If
    Next wb
    
    MsgBox "ä¿®æ­£å®Œäº†: " & fixCount & "å€‹ã®ã‚·ãƒ¼ãƒˆåã‚’ä¿®æ­£ã—ã¾ã—ãŸã€‚", vbInformation
End Sub